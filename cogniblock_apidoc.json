{"openapi":"3.1.0","info":{"title":"CogniBlock API","description":"CogniBlock Backend API with OCR Support","version":"2.0.0"},"paths":{"/api/v2/auth/login":{"get":{"tags":["authentication"],"summary":"Login","description":"重定向到OAuth授权页面","operationId":"login_api_v2_auth_login_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v2/auth/oauth/callback":{"get":{"tags":["authentication"],"summary":"Oauth Callback","description":"OAuth回调处理","operationId":"oauth_callback_api_v2_auth_oauth_callback_get","parameters":[{"name":"code","in":"query","required":true,"schema":{"type":"string","title":"Code"}},{"name":"state","in":"query","required":false,"schema":{"type":"string","title":"State"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v2/auth/logout":{"post":{"tags":["authentication"],"summary":"Logout","description":"登出","operationId":"logout_api_v2_auth_logout_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v2/users/{user_id}":{"get":{"tags":["users"],"summary":"Get User","description":"根据ID获取用户信息","operationId":"get_user_api_v2_users__user_id__get","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/User"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v2/ocr/process":{"post":{"tags":["ocr"],"summary":"OCR图片处理","description":"上传图片进行OCR处理\n\nArgs:\n    file: 上传的图片文件\n    \nReturns:\n    包含任务ID和WebSocket连接信息的响应","operationId":"process_image_api_v2_ocr_process_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_process_image_api_v2_ocr_process_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Process Image Api V2 Ocr Process Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v2/ocr/health":{"get":{"tags":["ocr"],"summary":"OCR服务健康检查","description":"OCR服务健康检查","operationId":"ocr_health_check_api_v2_ocr_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Ocr Health Check Api V2 Ocr Health Get"}}}}}}},"/api/v2/canva/pull":{"post":{"tags":["canvas"],"summary":"Pull Canvas","description":"拉取画布的当前状态\n\n获取指定画布的所有卡片及其位置和内容信息。\n用户必须有权限访问该画布。\n\nArgs:\n    request: 包含画布ID的请求\n    current_user: 当前认证用户\n    db: 数据库会话\n    \nReturns:\n    List[CardResponse]: 画布中所有卡片的列表\n    \nRaises:\n    HTTPException: \n        - 404: 画布不存在\n        - 403: 用户无权限访问画布\n        - 500: 服务器内部错误","operationId":"pull_canvas_api_v2_canva_pull_post","parameters":[{"name":"X-User-ID","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-User-Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CanvaPullRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CardResponse"},"title":"Response Pull Canvas Api V2 Canva Pull Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v2/canva/push":{"post":{"tags":["canvas"],"summary":"Push Canvas","description":"推送画布更新\n\n更新画布中卡片的位置和状态。支持批量更新操作。\n用户必须有权限修改该画布。\n\nArgs:\n    request: 包含画布ID和卡片更新数据的请求\n    current_user: 当前认证用户\n    db: 数据库会话\n    \nReturns:\n    dict: 成功响应消息\n    \nRaises:\n    HTTPException:\n        - 400: 请求数据格式错误\n        - 403: 用户无权限修改画布\n        - 404: 画布或卡片不存在\n        - 500: 服务器内部错误","operationId":"push_canvas_api_v2_canva_push_post","parameters":[{"name":"X-User-ID","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-User-Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CanvaPushRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v2/canva/info/{canvas_id}":{"get":{"tags":["canvas"],"summary":"Get Canvas Info","description":"获取画布基本信息\n\n获取画布的基本信息，包括名称、所有者、创建时间等。\n用户必须有权限访问该画布。\n\nArgs:\n    canvas_id: 画布ID\n    current_user: 当前认证用户\n    db: 数据库会话\n    \nReturns:\n    dict: 画布基本信息\n    \nRaises:\n    HTTPException:\n        - 403: 用户无权限访问画布\n        - 404: 画布不存在\n        - 500: 服务器内部错误","operationId":"get_canvas_info_api_v2_canva_info__canvas_id__get","parameters":[{"name":"canvas_id","in":"path","required":true,"schema":{"type":"integer","title":"Canvas Id"}},{"name":"X-User-ID","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-User-Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health":{"get":{"summary":"Health Check","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/ocr-test":{"get":{"summary":"Ocr Test","description":"重定向到OCR测试页面","operationId":"ocr_test_ocr_test_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"Body_process_image_api_v2_ocr_process_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_process_image_api_v2_ocr_process_post"},"CanvaPullRequest":{"properties":{"canva_id":{"type":"integer","exclusiveMinimum":0.0,"title":"Canva Id","description":"画布ID"}},"type":"object","required":["canva_id"],"title":"CanvaPullRequest","description":"拉取画布请求模型","example":{"canva_id":12}},"CanvaPushRequest":{"properties":{"canva_id":{"type":"integer","exclusiveMinimum":0.0,"title":"Canva Id","description":"画布ID"},"cards":{"items":{"$ref":"#/components/schemas/CardUpdateRequest"},"type":"array","minItems":1,"title":"Cards","description":"卡片更新列表"}},"type":"object","required":["canva_id","cards"],"title":"CanvaPushRequest","description":"推送画布更新请求模型","example":{"canva_id":12,"cards":[{"card_id":101,"content_id":104,"position":{"x":12.12,"y":86.21}},{"card_id":102,"content_id":101,"position":{"x":22.42,"y":81.15}}]}},"CardResponse":{"properties":{"card_id":{"type":"integer","title":"Card Id","description":"卡片ID"},"position":{"$ref":"#/components/schemas/PositionModel","description":"卡片位置"},"content_id":{"type":"integer","title":"Content Id","description":"内容ID"}},"type":"object","required":["card_id","position","content_id"],"title":"CardResponse","description":"卡片响应模型","example":{"card_id":101,"content_id":104,"position":{"x":12.12,"y":86.21}}},"CardUpdateRequest":{"properties":{"card_id":{"type":"integer","exclusiveMinimum":0.0,"title":"Card Id","description":"卡片ID"},"position":{"$ref":"#/components/schemas/PositionModel","description":"卡片位置"},"content_id":{"type":"integer","exclusiveMinimum":0.0,"title":"Content Id","description":"内容ID"}},"type":"object","required":["card_id","position","content_id"],"title":"CardUpdateRequest","description":"卡片更新请求模型","example":{"card_id":101,"content_id":104,"position":{"x":12.12,"y":86.21}}},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"PositionModel":{"properties":{"x":{"type":"number","minimum":0.0,"title":"X","description":"X坐标"},"y":{"type":"number","minimum":0.0,"title":"Y","description":"Y坐标"}},"type":"object","required":["x","y"],"title":"PositionModel","description":"位置模型","example":{"x":12.12,"y":86.21}},"User":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"oauth_id":{"type":"string","title":"Oauth Id"},"name":{"type":"string","title":"Name"},"email":{"type":"string","title":"Email"},"avatar":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Avatar"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","oauth_id","name","email","created_at","updated_at"],"title":"User"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}